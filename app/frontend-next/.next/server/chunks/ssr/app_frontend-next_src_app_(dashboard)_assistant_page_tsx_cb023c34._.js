module.exports=[39496,a=>{"use strict";var b=a.i(3236),c=a.i(91485),d=a.i(98544),e=a.i(51710),f=a.i(54593),g=a.i(30647),h=a.i(21944),i=a.i(94123),j=a.i(22784),k=a.i(15505),l=a.i(82530);let m=(0,l.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var n=a.i(92402);let o=(0,l.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var p=a.i(48616),q=a.i(55665),r=a.i(80049),s=a.i(96063),t=a.i(66843);let u=(0,l.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),v=(0,l.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var w=a.i(8611),x=a.i(75859),y=a.i(52790),z=a.i(36660),A=a.i(83805),B=a.i(92729);function C(a,b=!1){let c=a;return c=(c=(c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/```(\w*)\n([\s\S]*?)```/g,(a,b,c)=>{let d=b?`<span class="text-xs text-slate-400 absolute top-2 right-2">${b}</span>`:"";return`<div class="relative my-3"><pre class="bg-slate-900 text-slate-100 dark:bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm font-mono">${d}<code>${c.trim()}</code></pre></div>`})).replace(/`([^`]+)`/g,'<code class="bg-slate-200 dark:bg-slate-700 px-1.5 py-0.5 rounded text-sm font-mono">$1</code>'),b&&(c=(c=(c=c.replace(/^### (.+)$/gm,'<h3 class="text-lg font-semibold mt-4 mb-2">$1</h3>')).replace(/^## (.+)$/gm,'<h2 class="text-xl font-semibold mt-4 mb-2">$1</h2>')).replace(/^# (.+)$/gm,'<h1 class="text-2xl font-bold mt-4 mb-2">$1</h1>')),(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=c.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>")).replace(/\*([^*]+)\*/g,"<em>$1</em>")).replace(/_([^_]+)_/g,"<em>$1</em>")).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">$1</a>')).replace(/^(\d+)\. (.+)$/gm,'<li class="ml-4" value="$1">$2</li>')).replace(/(<li class="ml-4" value="\d+">[^<]+<\/li>\n?)+/g,'<ol class="list-decimal pl-4 space-y-1 my-2">$&</ol>')).replace(/^[-*] (.+)$/gm,'<li class="ml-4">$1</li>')).replace(/(<li class="ml-4">[^<]+<\/li>\n?)+/g,'<ul class="list-disc pl-4 space-y-1 my-2">$&</ul>')).replace(/^---$/gm,'<hr class="my-4 border-slate-300 dark:border-slate-600" />')).replace(/^&gt; (.+)$/gm,'<blockquote class="border-l-4 border-slate-300 dark:border-slate-600 pl-4 italic text-slate-600 dark:text-slate-400 my-2">$1</blockquote>')).replace(/^\|(.+)\|$/gm,(a,b)=>{let c=b.split("|").map(a=>a.trim());if(c.some(a=>a.match(/^-+$/)))return"";let d=c.map(a=>`<td class="border border-slate-300 dark:border-slate-600 px-3 py-2">${a}</td>`).join("");return`<tr>${d}</tr>`})).replace(/(<tr>.*<\/tr>\n?)+/g,'<table class="border-collapse border border-slate-300 dark:border-slate-600 my-3 w-full">$&</table>')).replace(/\n\n/g,'</p><p class="my-2">')).replace(/\n/g,"<br/>")).startsWith("<")||(c=`<p class="my-2">${c}</p>`),c}function D({message:a,onExpand:c}){let d="user"===a.role,e=!d&&!a.isLoading&&a.content.length>0;return(0,b.jsxs)("div",{className:(0,B.cn)("flex gap-3",d?"flex-row-reverse":"flex-row"),children:[(0,b.jsx)("div",{className:(0,B.cn)("flex h-8 w-8 shrink-0 items-center justify-center rounded-full",d?"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400":"bg-gradient-to-br from-purple-500 to-pink-500 text-white"),children:d?(0,b.jsx)(k.User,{className:"h-4 w-4"}):(0,b.jsx)(j.Bot,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:(0,B.cn)("flex flex-col gap-1",d?"items-end":"items-start"),children:[a.toolsUsed&&a.toolsUsed.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mb-1",children:a.toolsUsed.map(a=>(0,b.jsxs)(h.Badge,{variant:"outline",className:"text-xs py-0 px-1.5",children:[(0,b.jsx)(q.Wrench,{className:"h-3 w-3 mr-1"}),a.replace(/_/g," ")]},a))}),(0,b.jsxs)("div",{className:"group relative",children:[(0,b.jsx)("div",{className:(0,B.cn)("rounded-2xl px-4 py-2 max-w-[85%]",d?"bg-blue-600 text-white":"bg-slate-100 text-slate-900 dark:bg-slate-800 dark:text-slate-100",e&&"cursor-pointer hover:ring-2 hover:ring-purple-300 dark:hover:ring-purple-600 transition-all"),onClick:()=>e&&c?.(a),children:a.isLoading?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsx)("span",{className:"text-sm",children:"Se procesează..."})]}):(0,b.jsx)("div",{className:"text-sm leading-relaxed prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:C(a.content)}})}),e&&(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity bg-white dark:bg-slate-700 shadow-sm border",onClick:b=>{b.stopPropagation(),c?.(a)},children:(0,b.jsx)(u,{className:"h-3 w-3"})})]})]})]})}let E=["Câte vehicule avem în flotă?","Care sunt primele 5 vehicule cu consum mare?","Ce mentenanțe sunt programate?","Statistici combustibil luna aceasta","Lista șoferilor activi"];function F(){let[a,k]=(0,c.useState)([]),[l,u]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),P=(0,c.useRef)(null),Q=(0,c.useRef)(null),R=(0,z.useAuthStore)(a=>a.user),S=R?.role==="admin",T=a=>{K(a),M(!0),O(!1)},U=async()=>{if(J)try{await navigator.clipboard.writeText(J.content),O(!0),setTimeout(()=>O(!1),2e3)}catch(a){console.error("Failed to copy:",a)}},{data:V,isLoading:W}=(0,d.useQuery)({queryKey:["chat","health"],queryFn:()=>A.chatApi.getHealth(),refetchInterval:3e4});(0,c.useEffect)(()=>{P.current&&(P.current.scrollTop=P.current.scrollHeight)},[a]),(0,c.useEffect)(()=>{Q.current&&(Q.current.style.height="auto",Q.current.style.height=`${Math.min(Q.current.scrollHeight,200)}px`)},[l]);let X=()=>`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Y=(0,c.useCallback)(async b=>{let c=b||l.trim();if(!c||F)return;let d={id:X(),role:"user",content:c},e={id:X(),role:"assistant",content:"",isLoading:!0};k(a=>[...a,d,e]),u(""),G(!0),I([]);let f=[...a.map(a=>({role:a.role,content:a.content})),{role:"user",content:c}],g="",h=[];try{await A.chatApi.streamMessage(f,a=>{switch(a.type){case"tool_start":a.tools&&(I(a.tools),h=a.tools);break;case"tool_end":I([]);break;case"content":a.content&&(g+=a.content,k(a=>a.map(a=>a.id===e.id?{...a,content:g,isLoading:!1,toolsUsed:h}:a)));break;case"done":k(a=>a.map(a=>a.id===e.id?{...a,content:g||"Nu am putut genera un răspuns.",isLoading:!1,toolsUsed:h}:a));break;case"error":k(b=>b.map(b=>b.id===e.id?{...b,content:`Eroare: ${a.error||"Necunoscută"}`,isLoading:!1}:b))}},a=>{k(b=>b.map(b=>b.id===e.id?{...b,content:`Eroare: ${a.message}`,isLoading:!1}:b))})}catch(a){k(b=>b.map(b=>b.id===e.id?{...b,content:`Eroare: ${a instanceof Error?a.message:"Necunoscută"}`,isLoading:!1}:b))}finally{G(!1),I([])}},[l,F,a]);return(0,b.jsxs)("div",{className:"flex flex-col h-[calc(100vh-6rem)]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between pb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[(0,b.jsx)(o,{className:"h-6 w-6 text-purple-500"}),"Asistent AI"]}),(0,b.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"Întreabă-mă orice despre flotă, combustibil sau mentenanță"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[W?(0,b.jsx)(i.Skeleton,{className:"h-6 w-24"}):V?.available?(0,b.jsxs)(h.Badge,{variant:"outline",className:"bg-emerald-50 text-emerald-700 border-emerald-200 dark:bg-emerald-950 dark:text-emerald-400 dark:border-emerald-800",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-500 mr-2 animate-pulse"}),V.model]}):(0,b.jsxs)(h.Badge,{variant:"destructive",children:[(0,b.jsx)(p.AlertCircle,{className:"h-3 w-3 mr-1"}),"Indisponibil"]}),a.length>0&&(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{k([]),u("")},children:[(0,b.jsx)(r.Trash2,{className:"h-4 w-4 mr-1"}),"Șterge"]}),S&&(0,b.jsx)(y.default,{href:"/assistant/settings",children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(t.Settings,{className:"h-4 w-4 mr-1"}),"Setări"]})})]})]}),(0,b.jsxs)("div",{className:"flex-1 flex gap-4 min-h-0",children:[(0,b.jsxs)(e.Card,{className:(0,B.cn)("flex-1 flex flex-col min-h-0 transition-all duration-300",L?"w-1/2":"w-full"),children:[(0,b.jsx)("div",{className:"flex-1 overflow-auto p-4",ref:P,children:0===a.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,b.jsx)("div",{className:"rounded-full bg-gradient-to-br from-purple-500 to-pink-500 p-4 mb-4",children:(0,b.jsx)(j.Bot,{className:"h-8 w-8 text-white"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Bine ai venit!"}),(0,b.jsx)("p",{className:"text-slate-500 dark:text-slate-400 max-w-md mb-6",children:"Sunt asistentul tău pentru managementul flotei. Pot să te ajut cu informații despre vehicule, consum de combustibil, mentenanță și multe altele."}),(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2 max-w-lg",children:E.map(a=>(0,b.jsxs)(f.Button,{variant:"outline",className:"justify-start text-left h-auto py-2 px-3 text-sm",onClick:()=>Y(a),disabled:F||!V?.available,children:[(0,b.jsx)(o,{className:"h-3 w-3 mr-2 text-purple-500 shrink-0"}),(0,b.jsx)("span",{className:"truncate",children:a})]},a))})]}):(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsx)(D,{message:a,onExpand:T},a.id))})}),H.length>0&&(0,b.jsx)("div",{className:"px-4 py-2 border-t bg-slate-50 dark:bg-slate-900",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[(0,b.jsx)(n.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsx)("span",{children:"Se execută:"}),H.map(a=>(0,b.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:a.replace(/_/g," ")},a))]})}),(0,b.jsxs)("div",{className:"p-4 border-t",children:[!V?.available&&!W&&(0,b.jsx)("div",{className:"mb-3 p-3 rounded-lg bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(p.AlertCircle,{className:"h-4 w-4 text-amber-500 mt-0.5"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:"Serviciul LLM nu este disponibil"}),(0,b.jsx)("p",{className:"text-amber-600 dark:text-amber-500",children:V?.error||"Verifică configurația serverului"})]})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Textarea,{ref:Q,value:l,onChange:a=>u(a.target.value),onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),Y())},placeholder:"Scrie un mesaj... (Enter pentru a trimite, Shift+Enter pentru linie nouă)",className:"min-h-[44px] max-h-[200px] resize-none",disabled:F||!V?.available,rows:1}),(0,b.jsx)(f.Button,{onClick:()=>Y(),disabled:!l.trim()||F||!V?.available,className:"shrink-0",children:F?(0,b.jsx)(n.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(m,{className:"h-4 w-4"})})]}),(0,b.jsxs)("p",{className:"text-xs text-slate-400 mt-2 flex items-center gap-1",children:[(0,b.jsx)(s.Info,{className:"h-3 w-3"}),"Asistentul poate face greșeli. Verifică informațiile importante."]})]})]}),(0,b.jsx)("div",{className:(0,B.cn)("transition-all duration-300 ease-in-out overflow-hidden",L?"w-1/2 opacity-100":"w-0 opacity-0"),children:L&&J&&(0,b.jsxs)(e.Card,{className:"h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-slate-50 dark:bg-slate-900",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-purple-500 to-pink-500 text-white",children:(0,b.jsx)(j.Bot,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Răspuns Asistent"}),J.toolsUsed&&J.toolsUsed.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:J.toolsUsed.map(a=>(0,b.jsxs)(h.Badge,{variant:"outline",className:"text-xs py-0 px-1.5",children:[(0,b.jsx)(q.Wrench,{className:"h-3 w-3 mr-1"}),a.replace(/_/g," ")]},a))})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:U,children:N?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w.Check,{className:"h-4 w-4 mr-1 text-emerald-500"}),"Copiat"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v,{className:"h-4 w-4 mr-1"}),"Copiază"]})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>{M(!1)},className:"h-8 w-8",children:(0,b.jsx)(x.X,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-4",children:(0,b.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none leading-relaxed",dangerouslySetInnerHTML:{__html:C(J.content,!0)}})})]})})]})]})}a.s(["default",()=>F],39496)}];

//# sourceMappingURL=app_frontend-next_src_app_%28dashboard%29_assistant_page_tsx_cb023c34._.js.map