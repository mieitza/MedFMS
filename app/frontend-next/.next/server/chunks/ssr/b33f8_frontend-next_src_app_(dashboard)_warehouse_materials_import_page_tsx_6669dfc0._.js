module.exports=[38787,a=>{"use strict";var b=a.i(3236),c=a.i(91485),d=a.i(52790),e=a.i(73248),f=a.i(13942),g=a.i(51710),h=a.i(54593),i=a.i(64725),j=a.i(9307),k=a.i(21944),l=a.i(26528),m=a.i(94683),n=a.i(61335),o=a.i(96988),p=a.i(10063),q=a.i(943),r=a.i(62186),s=a.i(38121),t=a.i(93473),u=a.i(92402),v=a.i(90654),w=a.i(4393),x=a.i(30067),y=a.i(25181);function z(){let a=(0,f.useQueryClient)(),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),H=(0,e.useMutation)({mutationFn:a=>y.warehouseApi.importMaterials(a),onSuccess:b=>{E(b),b.imported>0&&(n.toast.success(`${b.imported} materiale importate cu succes`),a.invalidateQueries({queryKey:["warehouse"]}),a.invalidateQueries({queryKey:["materials"]})),b.errors.length>0&&n.toast.error(`${b.errors.length} erori la import`)},onError:a=>{n.toast.error(a.message||"Eroare la import")}}),I=(0,c.useCallback)(async a=>{let b=(await a.text()).split("\n").filter(a=>a.trim());if(b.length<2)return void n.toast.error("Fișierul nu conține date");let c=b[0].split(",").map(a=>a.trim().toLowerCase()),d=[];for(let a=1;a<Math.min(b.length,11);a++){let e=b[a].split(",").map(a=>a.trim().replace(/^"|"$/g,"")),f={rowNumber:a+1,isValid:!0,errors:[]};c.forEach((a,b)=>{let c=e[b];a.includes("cod")||a.includes("code")?f.materialCode=c:a.includes("denumire")||a.includes("name")||a.includes("nume")?f.name=c:a.includes("descriere")||a.includes("description")?f.description=c:a.includes("categorie")||a.includes("category")?f.category=c:a.includes("unitate")||a.includes("unit")?f.unit=c:a.includes("stoc")||a.includes("stock")||a.includes("cantitate")?f.currentStock=parseFloat(c)||0:a.includes("critic")||a.includes("critical")||a.includes("minim")?f.criticalLevel=parseFloat(c)||0:a.includes("pret")||a.includes("price")?f.standardPrice=parseFloat(c)||0:(a.includes("depozit")||a.includes("warehouse"))&&(f.warehouse=c)}),f.materialCode||(f.isValid=!1,f.errors.push("Lipsește codul materialului")),f.name||(f.isValid=!1,f.errors.push("Lipsește denumirea")),d.push(f)}C(d)},[]),J=(0,c.useCallback)(a=>{if(!a)return;let b=[".xlsx",".xls",".csv"].some(b=>a.name.toLowerCase().endsWith(b));["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(a.type)||b?a.size>0xa00000?n.toast.error("Fișierul este prea mare. Dimensiunea maximă este 10MB."):(A(a),E(null),C([]),a.name.toLowerCase().endsWith(".csv")&&I(a)):n.toast.error("Format de fișier invalid. Acceptăm doar fișiere Excel (.xlsx, .xls) sau CSV.")},[I]),K=(0,c.useCallback)(a=>{a.preventDefault(),G(!0)},[]),L=(0,c.useCallback)(a=>{a.preventDefault(),G(!1)},[]),M=(0,c.useCallback)(a=>{a.preventDefault(),G(!1),J(a.dataTransfer.files[0])},[J]),N=()=>{A(null),C([]),E(null)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(d.default,{href:"/warehouse",children:[(0,b.jsx)(o.ArrowLeft,{className:"h-4 w-4 mr-1"}),"Înapoi la Depozit"]})})}),(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Import Materiale"}),(0,b.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"Importă materiale din fișiere Excel sau CSV"})]}),(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>{let a=new Blob(["\uFEFFcod_material,denumire,descriere,categorie,unitate,stoc_curent,nivel_critic,pret_standard,depozit\nMAT001,Ulei motor 5W40,Ulei sintetic premium,Lubrifianți,litru,50,10,75.50,Depozit Principal"],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(a),b.download="template-import-materiale.csv",b.click()},children:[(0,b.jsx)(v.Download,{className:"mr-2 h-4 w-4"}),"Descarcă Template"]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(w.FileText,{className:"h-5 w-5"}),"Instrucțiuni"]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsx)("p",{children:"Fișierul de import trebuie să conțină următoarele coloane:"}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-slate-600 dark:text-slate-400",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"cod_material"})," - Codul unic al materialului (obligatoriu)"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"denumire"})," - Denumirea materialului (obligatoriu)"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"descriere"})," - Descrierea materialului"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"categorie"})," - Categoria materialului"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"unitate"})," - Unitatea de măsură"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"stoc_curent"})," - Stocul curent"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"nivel_critic"})," - Nivelul critic de stoc"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"pret_standard"})," - Prețul standard în RON"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"depozit"})," - Numele depozitului"]})]}),(0,b.jsx)("p",{className:"mt-4 text-slate-500",children:"Formate acceptate: .xlsx, .xls, .csv | Dimensiune maximă: 10MB"})]})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Încarcă Fișier"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${F?"border-primary bg-primary/5":"border-slate-200 dark:border-slate-700 hover:border-primary/50"}`,onDragOver:K,onDragLeave:L,onDrop:M,children:z?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,b.jsx)(q.FileSpreadsheet,{className:"h-12 w-12 text-green-600"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("p",{className:"font-medium",children:z.name}),(0,b.jsxs)("p",{className:"text-sm text-slate-500",children:[(z.size/1024).toFixed(2)," KB"]})]})]}),(0,b.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:N,children:"Schimbă Fișierul"}),(0,b.jsxs)(h.Button,{onClick:()=>{z&&H.mutate(z)},disabled:H.isPending,children:[H.isPending&&(0,b.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),(0,b.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Importă"]})]})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(x.Package,{className:"h-12 w-12 mx-auto text-slate-400"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Trage fișierul aici sau click pentru a selecta"}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Acceptă fișiere Excel (.xlsx, .xls) sau CSV"})]}),(0,b.jsxs)(j.Label,{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,b.jsx)(i.Input,{id:"file-upload",type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:a=>J(a.target.files?.[0]||null)}),(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)("span",{children:"Selectează Fișier"})})]})]})})})]}),B.length>0&&!D&&(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Previzualizare Date"}),(0,b.jsxs)(g.CardDescription,{children:["Primele ",B.length," rânduri din fișier"]})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"rounded-md border overflow-x-auto",children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{className:"w-12",children:"#"}),(0,b.jsx)(l.TableHead,{children:"Cod"}),(0,b.jsx)(l.TableHead,{children:"Denumire"}),(0,b.jsx)(l.TableHead,{children:"Categorie"}),(0,b.jsx)(l.TableHead,{children:"Unitate"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Stoc"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Critic"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Preț"}),(0,b.jsx)(l.TableHead,{children:"Depozit"}),(0,b.jsx)(l.TableHead,{children:"Status"})]})}),(0,b.jsx)(l.TableBody,{children:B.map(a=>(0,b.jsxs)(l.TableRow,{className:a.isValid?"":"bg-red-50 dark:bg-red-950/20",children:[(0,b.jsx)(l.TableCell,{children:a.rowNumber}),(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.materialCode||"-"}),(0,b.jsx)(l.TableCell,{children:a.name||"-"}),(0,b.jsx)(l.TableCell,{children:a.category||"-"}),(0,b.jsx)(l.TableCell,{children:a.unit||"-"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.currentStock??"-"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.criticalLevel??"-"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.standardPrice?.toFixed(2)||"-"}),(0,b.jsx)(l.TableCell,{children:a.warehouse||"-"}),(0,b.jsx)(l.TableCell,{children:a.isValid?(0,b.jsxs)(k.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[(0,b.jsx)(r.CheckCircle,{className:"h-3 w-3 mr-1"}),"Valid"]}):(0,b.jsxs)(k.Badge,{variant:"destructive",children:[(0,b.jsx)(s.XCircle,{className:"h-3 w-3 mr-1"}),"Invalid"]})})]},a.rowNumber))})]})})})]}),D&&(0,b.jsxs)("div",{className:"space-y-4",children:[D.imported>0&&(0,b.jsxs)(m.Alert,{className:"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950/30",children:[(0,b.jsx)(r.CheckCircle,{className:"h-4 w-4 text-green-600"}),(0,b.jsx)(m.AlertTitle,{className:"text-green-800 dark:text-green-200",children:"Import Reușit"}),(0,b.jsxs)(m.AlertDescription,{className:"text-green-700 dark:text-green-300",children:[D.imported," materiale au fost importate cu succes."]})]}),D.errors.length>0&&(0,b.jsxs)(m.Alert,{variant:"destructive",children:[(0,b.jsx)(t.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(m.AlertTitle,{children:"Erori la Import"}),(0,b.jsx)(m.AlertDescription,{children:(0,b.jsxs)("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[D.errors.slice(0,10).map((a,c)=>(0,b.jsx)("li",{children:a},c)),D.errors.length>10&&(0,b.jsxs)("li",{className:"text-slate-500",children:["... și încă ",D.errors.length-10," erori"]})]})})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:N,children:"Import Nou"}),(0,b.jsx)(h.Button,{asChild:!0,children:(0,b.jsx)(d.default,{href:"/warehouse",children:"Vezi Materialele"})})]})]})]})}a.s(["default",()=>z])}];

//# sourceMappingURL=b33f8_frontend-next_src_app_%28dashboard%29_warehouse_materials_import_page_tsx_6669dfc0._.js.map