module.exports=[60478,a=>{"use strict";var b=a.i(3236),c=a.i(91485),d=a.i(52790),e=a.i(36305),f=a.i(98544),g=a.i(73248),h=a.i(13942),i=a.i(51710),j=a.i(54593),k=a.i(21944),l=a.i(94123),m=a.i(92687),n=a.i(64725),o=a.i(9307),p=a.i(30647),q=a.i(26528),r=a.i(69492),s=a.i(46863),t=a.i(96988),u=a.i(62186),v=a.i(38121),w=a.i(14874),x=a.i(52472),y=a.i(93473),z=a.i(19061),A=a.i(35168),B=a.i(42391);a.i(50582);var C=a.i(41992),D=a.i(61335);let E={1:{label:"Urgent",color:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"},2:{label:"Ridicată",color:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400"},3:{label:"Normal",color:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"},4:{label:"Scăzută",color:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"},5:{label:"Opțional",color:"bg-slate-100 text-slate-800 dark:bg-slate-800 dark:text-slate-400"}},F=[{value:"all",label:"Toate prioritățile"},{value:"1",label:"Urgent"},{value:"2",label:"Ridicată"},{value:"3",label:"Normal"},{value:"4",label:"Scăzută"},{value:"5",label:"Opțional"}];function G(){let a=(0,e.useRouter)(),G=(0,h.useQueryClient)(),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("all"),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(1),{data:V,isLoading:W,refetch:X}=(0,f.useQuery)({queryKey:["maintenance","pending-approval",J,T],queryFn:()=>C.maintenanceApi.getPendingApproval({page:T,pageSize:20,..."all"!==J?{priority:parseInt(J)}:{}})}),Y=V?.data||[],Z=(0,c.useMemo)(()=>{if(!H)return Y;let a=H.toLowerCase();return Y.filter(b=>b.workOrderNumber?.toLowerCase().includes(a)||b.vehicle?.vehicleCode?.toLowerCase().includes(a)||b.vehicle?.licensePlate?.toLowerCase().includes(a)||b.title?.toLowerCase().includes(a))},[Y,H]),$=(0,g.useMutation)({mutationFn:({id:a,notes:b})=>C.maintenanceApi.approve(a,b),onSuccess:()=>{G.invalidateQueries({queryKey:["maintenance"]}),D.toast.success("Comandă de lucru aprobată cu succes"),Q(!1),M(null),O("")},onError:a=>{D.toast.error(`Eroare la aprobare: ${a.message}`)}}),_=(0,g.useMutation)({mutationFn:({id:a,notes:b})=>C.maintenanceApi.reject(a,b),onSuccess:()=>{G.invalidateQueries({queryKey:["maintenance"]}),D.toast.success("Comandă de lucru respinsă"),S(!1),M(null),O("")},onError:a=>{D.toast.error(`Eroare la respingere: ${a.message}`)}});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(d.default,{href:"/maintenance",children:[(0,b.jsx)(t.ArrowLeft,{className:"h-4 w-4 mr-1"}),"Înapoi"]})})}),(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Aprobări Mentenanță"}),(0,b.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"Comenzi de lucru în așteptarea aprobării"})]})}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{children:"Filtre"})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:"Căutare"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(B.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,b.jsx)(n.Input,{placeholder:"Caută după nr. comandă, vehicul...",value:H,onChange:a=>I(a.target.value),className:"pl-9"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:"Prioritate"}),(0,b.jsxs)(m.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Selectează prioritatea"})}),(0,b.jsx)(m.SelectContent,{children:F.map(a=>(0,b.jsx)(m.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>{I(""),K("all"),U(1)},children:"Resetează filtrele"})})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(i.Card,{children:(0,b.jsx)(i.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-orange-100 dark:bg-orange-900/30 text-orange-600",children:(0,b.jsx)(z.Clock,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"În așteptare"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:Z.length})]})]})})}),(0,b.jsx)(i.Card,{children:(0,b.jsx)(i.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-red-100 dark:bg-red-900/30 text-red-600",children:(0,b.jsx)(y.AlertTriangle,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Urgente"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:Z.filter(a=>1===a.priority).length})]})]})})}),(0,b.jsx)(i.Card,{children:(0,b.jsx)(i.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600",children:(0,b.jsx)(w.Car,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Vehicule Afectate"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:new Set(Z.map(a=>a.vehicle?.id)).size})]})]})})}),(0,b.jsx)(i.Card,{children:(0,b.jsx)(i.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 rounded-full bg-green-100 dark:bg-green-900/30 text-green-600",children:(0,b.jsx)(x.DollarSign,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Cost Estimat Total"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[Z.reduce((a,b)=>a+(parseFloat(String(b.estimatedCost))||0),0).toFixed(0)," RON"]})]})]})})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsx)(i.CardTitle,{children:"Comenzi în Așteptare"}),(0,b.jsxs)(i.CardDescription,{children:[Z.length," comenzi de lucru necesită aprobare"]})]}),(0,b.jsx)(i.CardContent,{children:W?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(l.Skeleton,{className:"h-12 w-full"}),(0,b.jsx)(l.Skeleton,{className:"h-12 w-full"}),(0,b.jsx)(l.Skeleton,{className:"h-12 w-full"})]}):0===Z.length?(0,b.jsxs)("div",{className:"py-12 text-center",children:[(0,b.jsx)(u.CheckCircle,{className:"h-12 w-12 mx-auto text-green-500 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Toate comenzile au fost procesate"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Nu există comenzi de lucru în așteptarea aprobării."})]}):(0,b.jsx)("div",{className:"rounded-md border overflow-hidden",children:(0,b.jsxs)(q.Table,{children:[(0,b.jsx)(q.TableHeader,{children:(0,b.jsxs)(q.TableRow,{children:[(0,b.jsx)(q.TableHead,{children:"Nr. Comandă"}),(0,b.jsx)(q.TableHead,{children:"Vehicul"}),(0,b.jsx)(q.TableHead,{children:"Titlu"}),(0,b.jsx)(q.TableHead,{children:"Prioritate"}),(0,b.jsx)(q.TableHead,{children:"Data Programată"}),(0,b.jsx)(q.TableHead,{className:"text-right",children:"Cost Estimat"}),(0,b.jsx)(q.TableHead,{className:"text-right",children:"Acțiuni"})]})}),(0,b.jsx)(q.TableBody,{children:Z.map(c=>{let d;return(0,b.jsxs)(q.TableRow,{children:[(0,b.jsx)(q.TableCell,{className:"font-medium",children:c.workOrderNumber}),(0,b.jsx)(q.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.vehicle?.vehicleCode}),(0,b.jsx)("div",{className:"text-sm text-slate-500",children:c.vehicle?.licensePlate})]})}),(0,b.jsx)(q.TableCell,{children:(0,b.jsxs)("div",{className:"max-w-[200px]",children:[(0,b.jsx)("div",{className:"truncate font-medium",children:c.title}),(0,b.jsx)("div",{className:"text-sm text-slate-500 truncate",children:c.maintenanceType?.name})]})}),(0,b.jsx)(q.TableCell,{children:(d=E[c.priority||3]||E[3],(0,b.jsx)(k.Badge,{className:d.color,variant:"secondary",children:d.label}))}),(0,b.jsx)(q.TableCell,{children:c.scheduledDate?new Date(c.scheduledDate).toLocaleDateString("ro-RO"):"-"}),(0,b.jsx)(q.TableCell,{className:"text-right",children:c.estimatedCost?`${parseFloat(String(c.estimatedCost)).toFixed(0)} RON`:"-"}),(0,b.jsx)(q.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",onClick:()=>a.push(`/maintenance/${c.id}`),children:(0,b.jsx)(A.Eye,{className:"h-4 w-4"})}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>{M(c),O(""),Q(!0)},children:(0,b.jsx)(u.CheckCircle,{className:"h-4 w-4"})}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{M(c),O(""),S(!0)},children:(0,b.jsx)(v.XCircle,{className:"h-4 w-4"})})]})})]},c.id)})})]})})})]}),(0,b.jsx)(r.Dialog,{open:P,onOpenChange:Q,children:(0,b.jsxs)(r.DialogContent,{className:"max-w-lg",children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{children:"Aprobă Comanda de Lucru"}),(0,b.jsx)(r.DialogDescription,{children:"Confirmați aprobarea comenzii de lucru pentru execuție."})]}),L&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"Nr. Comandă:"}),(0,b.jsx)("span",{children:L.workOrderNumber})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"Vehicul:"}),(0,b.jsxs)("span",{children:[L.vehicle?.vehicleCode," (",L.vehicle?.licensePlate,")"]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"Tip:"}),(0,b.jsx)("span",{children:L.maintenanceType?.name})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"Cost Estimat:"}),(0,b.jsx)("span",{children:L.estimatedCost?`${parseFloat(String(L.estimatedCost)).toFixed(2)} RON`:"-"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{children:"Note de Aprobare (opțional)"}),(0,b.jsx)(p.Textarea,{value:N,onChange:a=>O(a.target.value),placeholder:"Adăugați note sau comentarii...",rows:3})]})]}),(0,b.jsxs)(r.DialogFooter,{children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>Q(!1),disabled:$.isPending,children:"Anulează"}),(0,b.jsx)(j.Button,{onClick:()=>{L&&$.mutate({id:L.id,notes:N||void 0})},disabled:$.isPending,className:"bg-green-600 hover:bg-green-700",children:$.isPending?"Se procesează...":"Aprobă"})]})]})}),(0,b.jsx)(s.AlertDialog,{open:R,onOpenChange:S,children:(0,b.jsxs)(s.AlertDialogContent,{children:[(0,b.jsxs)(s.AlertDialogHeader,{children:[(0,b.jsx)(s.AlertDialogTitle,{children:"Respinge Comanda de Lucru"}),(0,b.jsx)(s.AlertDialogDescription,{children:"Această acțiune va respinge comanda de lucru. Motivul respingerii este obligatoriu."})]}),L&&(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"Nr. Comandă:"}),(0,b.jsx)("span",{children:L.workOrderNumber})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:"Titlu:"}),(0,b.jsx)("span",{children:L.title})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.Label,{children:["Motivul Respingerii ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(p.Textarea,{value:N,onChange:a=>O(a.target.value),placeholder:"Introduceți motivul respingerii...",rows:3,required:!0})]})]}),(0,b.jsxs)(s.AlertDialogFooter,{children:[(0,b.jsx)(s.AlertDialogCancel,{disabled:_.isPending,children:"Anulează"}),(0,b.jsx)(s.AlertDialogAction,{onClick:a=>{a.preventDefault(),N.trim()?L&&_.mutate({id:L.id,notes:N}):D.toast.error("Motivul respingerii este obligatoriu")},disabled:_.isPending||!N.trim(),className:"bg-red-600 hover:bg-red-700",children:_.isPending?"Se procesează...":"Respinge"})]})]})})]})}a.s(["default",()=>G])}];

//# sourceMappingURL=app_frontend-next_src_app_%28dashboard%29_maintenance_approvals_page_tsx_1927e639._.js.map