module.exports=[29883,a=>{"use strict";var b=a.i(3236),c=a.i(91485),d=a.i(52790),e=a.i(98544),f=a.i(51710),g=a.i(54593),h=a.i(94123),i=a.i(92687),j=a.i(64725),k=a.i(9307),l=a.i(26528),m=a.i(96988),n=a.i(90654),o=a.i(46811),p=a.i(14874),q=a.i(59489),r=a.i(90308),s=a.i(23617),t=a.i(4631),u=a.i(52472),v=a.i(44600),w=a.i(96063);a.i(50582);var x=a.i(65442),y=a.i(62416);function z({title:a,value:c,suffix:d="",icon:e,color:g,change:i,changeLabel:j,loading:k=!1}){return(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`p-3 rounded-full ${g}`,children:(0,b.jsx)(e,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm text-slate-500",children:a}),k?(0,b.jsx)(h.Skeleton,{className:"h-8 w-24"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"text-2xl font-bold",children:["number"==typeof c?c.toLocaleString("ro-RO",{maximumFractionDigits:2}):c,d&&(0,b.jsx)("span",{className:"text-sm font-normal text-slate-500 ml-1",children:d})]}),void 0!==i&&j&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm mt-1",children:[i>0?(0,b.jsx)(r.TrendingUp,{className:"h-4 w-4 text-green-500"}):i<0?(0,b.jsx)(s.TrendingDown,{className:"h-4 w-4 text-red-500"}):null,(0,b.jsxs)("span",{className:i>0?"text-green-600":i<0?"text-red-600":"text-slate-500",children:[i>0?"+":"",i.toFixed(1),"%"]}),(0,b.jsxs)("span",{className:"text-slate-500 text-xs ml-1",children:["vs ",j]})]})]})]})]})})})}function A(){let a,s,A=((s=new Date(a=new Date)).setDate(s.getDate()-30),{start:s.toISOString().split("T")[0],end:a.toISOString().split("T")[0]}),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(A.start),[F,G]=(0,c.useState)(A.end),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)("week"),{data:L}=(0,e.useQuery)({queryKey:["vehicles","all"],queryFn:()=>y.vehiclesApi.getAll({pageSize:1e3})}),M=L?.data||[],{data:N,isLoading:O,refetch:P}=(0,e.useQuery)({queryKey:["fuel","transactions","daily",B,D,F],queryFn:()=>x.fuelApi.getAll({vehicleId:parseInt(B),dateFrom:D,dateTo:F,pageSize:1e4}),enabled:!!B&&!!D&&!!F}),Q=N?.data||[],{dailyStats:R,totalStats:S}=(0,c.useMemo)(()=>{if(!Q||0===Q.length)return{dailyStats:[],totalStats:{totalDistance:0,totalFuel:0,totalCost:0,avgConsumption:0,totalDays:0}};let a=[...Q].sort((a,b)=>new Date(a.transactionDate).getTime()-new Date(b.transactionDate).getTime()),b={};a.forEach(a=>{let c=new Date(a.transactionDate).toISOString().split("T")[0];b[c]||(b[c]={date:c,transactions:[],fuelUsed:0,cost:0,minOdometer:null,maxOdometer:null}),b[c].transactions.push(a),b[c].fuelUsed+=parseFloat(String(a.quantity))||0,b[c].cost+=parseFloat(String(a.totalCost))||0;let d=parseFloat(String(a.odometer))||0;d>0&&((null===b[c].minOdometer||d<b[c].minOdometer)&&(b[c].minOdometer=d),(null===b[c].maxOdometer||d>b[c].maxOdometer)&&(b[c].maxOdometer=d))});let c=Object.values(b).map(a=>{let b=0;null!==a.maxOdometer&&null!==a.minOdometer&&(b=a.maxOdometer-a.minOdometer);let c=b>0?a.fuelUsed/b*100:null,d=b>0?a.cost/b:null;return{date:a.date,distance:b,fuelUsed:a.fuelUsed,consumption:c,cost:a.cost,costPerKm:d,transactions:a.transactions.length}}).sort((a,b)=>b.date.localeCompare(a.date)),d=c.filter(a=>null!==a.consumption&&a.consumption>0).map(a=>a.consumption),e={totalDistance:c.reduce((a,b)=>a+b.distance,0),totalFuel:c.reduce((a,b)=>a+b.fuelUsed,0),totalCost:c.reduce((a,b)=>a+b.cost,0),avgConsumption:d.length>0?d.reduce((a,b)=>a+b,0)/d.length:0,totalDays:c.length};return{dailyStats:c,totalStats:e}},[Q]),T=(0,c.useMemo)(()=>{let a,b;if(!H||!D||!F)return null;let c=new Date(D),d=new Date(F);return"day"===J?((a=new Date(c)).setDate(a.getDate()-1),(b=new Date(d)).setDate(b.getDate()-1)):"week"===J?((a=new Date(c)).setDate(a.getDate()-7),(b=new Date(d)).setDate(b.getDate()-7)):((a=new Date(c)).setMonth(a.getMonth()-1),(b=new Date(d)).setMonth(b.getMonth()-1)),{startDate:a.toISOString().split("T")[0],endDate:b.toISOString().split("T")[0]}},[H,D,F,J]),{data:U}=(0,e.useQuery)({queryKey:["fuel","transactions","daily-comparison",B,T],queryFn:()=>x.fuelApi.getAll({vehicleId:parseInt(B),dateFrom:T.startDate,dateTo:T.endDate,pageSize:1e4}),enabled:!!B&&!!T&&H}),V=(0,c.useMemo)(()=>{if(!U?.data||0===U.data.length)return null;let a=[...U.data].sort((a,b)=>new Date(a.transactionDate).getTime()-new Date(b.transactionDate).getTime()),b={};a.forEach(a=>{let c=new Date(a.transactionDate).toISOString().split("T")[0];b[c]||(b[c]={fuelUsed:0,cost:0,minOdometer:null,maxOdometer:null}),b[c].fuelUsed+=parseFloat(String(a.quantity))||0,b[c].cost+=parseFloat(String(a.totalCost))||0;let d=parseFloat(String(a.odometer))||0;d>0&&((null===b[c].minOdometer||d<b[c].minOdometer)&&(b[c].minOdometer=d),(null===b[c].maxOdometer||d>b[c].maxOdometer)&&(b[c].maxOdometer=d))});let c=Object.values(b).map(a=>{let b=0;null!==a.maxOdometer&&null!==a.minOdometer&&(b=a.maxOdometer-a.minOdometer);let c=b>0?a.fuelUsed/b*100:null;return{distance:b,fuelUsed:a.fuelUsed,consumption:c,cost:a.cost}}),d=c.filter(a=>null!==a.consumption&&a.consumption>0).map(a=>a.consumption),e={totalDistance:c.reduce((a,b)=>a+b.distance,0),totalFuel:c.reduce((a,b)=>a+b.fuelUsed,0),totalCost:c.reduce((a,b)=>a+b.cost,0),avgConsumption:d.length>0?d.reduce((a,b)=>a+b,0)/d.length:0};return{distanceChange:e.totalDistance>0?(S.totalDistance-e.totalDistance)/e.totalDistance*100:0,fuelChange:e.totalFuel>0?(S.totalFuel-e.totalFuel)/e.totalFuel*100:0,costChange:e.totalCost>0?(S.totalCost-e.totalCost)/e.totalCost*100:0,consumptionChange:e.avgConsumption>0?(S.avgConsumption-e.avgConsumption)/e.avgConsumption*100:0}},[U,S]),W=()=>"day"===J?"Ziua Anterioară":"week"===J?"Săptămâna Anterioară":"Luna Anterioară",X=()=>{let a=M.find(a=>a.id===parseInt(B));return a?`${a.vehicleCode} - ${a.licensePlate}`:""};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,b.jsx)(g.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(d.default,{href:"/fuel/reports",children:[(0,b.jsx)(m.ArrowLeft,{className:"h-4 w-4 mr-1"}),"Înapoi la Rapoarte"]})})}),(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Raport Zilnic Vehicule"}),(0,b.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"Statistici zilnice: km parcurși, combustibil consumat și consum mediu per 100km"})]})}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Filtre"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{children:"Vehicul *"}),(0,b.jsxs)(i.Select,{value:B,onValueChange:C,children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"Selectează vehiculul"})}),(0,b.jsx)(i.SelectContent,{children:M.map(a=>(0,b.jsxs)(i.SelectItem,{value:String(a.id),children:[a.vehicleCode," - ",a.licensePlate]},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{children:"Data început"}),(0,b.jsx)(j.Input,{type:"date",value:D,onChange:a=>E(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{children:"Data sfârșit"}),(0,b.jsx)(j.Input,{type:"date",value:F,onChange:a=>G(a.target.value)})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(g.Button,{className:"w-full",onClick:()=>P(),disabled:!B,children:[(0,b.jsx)(t.BarChart3,{className:"mr-2 h-4 w-4"}),"Generează Raport"]})})]})})]}),B?O?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(h.Skeleton,{className:"h-[100px] w-full"}),(0,b.jsxs)("div",{className:"grid grid-cols-5 gap-4",children:[(0,b.jsx)(h.Skeleton,{className:"h-[120px]"}),(0,b.jsx)(h.Skeleton,{className:"h-[120px]"}),(0,b.jsx)(h.Skeleton,{className:"h-[120px]"}),(0,b.jsx)(h.Skeleton,{className:"h-[120px]"}),(0,b.jsx)(h.Skeleton,{className:"h-[120px]"})]}),(0,b.jsx)(h.Skeleton,{className:"h-[400px] w-full"})]}):R.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:X()}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[H&&(0,b.jsxs)(i.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-[200px]",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"day",children:"vs Ziua Anterioară"}),(0,b.jsx)(i.SelectItem,{value:"week",children:"vs Săptămâna Anterioară"}),(0,b.jsx)(i.SelectItem,{value:"month",children:"vs Luna Anterioară"})]})]}),(0,b.jsxs)(g.Button,{variant:H?"default":"outline",onClick:()=>I(!H),children:[(0,b.jsx)(t.BarChart3,{className:"mr-2 h-4 w-4"}),H?"Ascunde Comparație":"Arată Comparație"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,b.jsx)(z,{title:"Zile cu Date",value:S.totalDays,icon:o.Calendar,color:"bg-blue-100 dark:bg-blue-900/30 text-blue-600",loading:O}),(0,b.jsx)(z,{title:"Total Km",value:S.totalDistance.toFixed(2),icon:v.Gauge,color:"bg-green-100 dark:bg-green-900/30 text-green-600",change:H&&V?V.distanceChange:void 0,changeLabel:H?W():void 0,loading:O}),(0,b.jsx)(z,{title:"Total Combustibil",value:S.totalFuel.toFixed(2),suffix:"L",icon:q.Fuel,color:"bg-purple-100 dark:bg-purple-900/30 text-purple-600",change:H&&V?V.fuelChange:void 0,changeLabel:H?W():void 0,loading:O}),(0,b.jsx)(z,{title:"Consum Mediu",value:S.avgConsumption.toFixed(2),suffix:"L/100km",icon:r.TrendingUp,color:"bg-orange-100 dark:bg-orange-900/30 text-orange-600",change:H&&V?V.consumptionChange:void 0,changeLabel:H?W():void 0,loading:O}),(0,b.jsx)(z,{title:"Cost Total",value:S.totalCost.toFixed(2),suffix:"RON",icon:u.DollarSign,color:"bg-red-100 dark:bg-red-900/30 text-red-600",change:H&&V?V.costChange:void 0,changeLabel:H?W():void 0,loading:O})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>{if(0===R.length)return void alert("Nu există date pentru export");let a=new Blob(["\uFEFF"+["Data,Km Parcurși,Combustibil Folosit (L),Consum (L/100km),Cost Total (RON),Cost/km (RON),Număr Alimentări",...R.map(a=>{let b=new Date(a.date),c=String(b.getDate()).padStart(2,"0"),d=String(b.getMonth()+1).padStart(2,"0"),e=b.getFullYear();return[`${c}/${d}/${e}`,a.distance?a.distance.toFixed(2):"N/A",a.fuelUsed?a.fuelUsed.toFixed(2):"N/A",a.consumption?a.consumption.toFixed(2):"N/A",a.cost?a.cost.toFixed(2):"N/A",a.costPerKm?a.costPerKm.toFixed(2):"N/A",a.transactions]}).map(a=>a.map(a=>`"${a}"`).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(a);let c=X().replace(/\s/g,"-")||"vehicle";b.download=`raport-zilnic-${c}-${new Date().toISOString().split("T")[0]}.csv`,b.click()},children:[(0,b.jsx)(n.Download,{className:"mr-2 h-4 w-4"}),"Export CSV"]})}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Statistici Zilnice"}),(0,b.jsxs)(f.CardDescription,{children:[R.length," zile cu date"]})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"rounded-md border overflow-hidden",children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Data"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Km"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Combustibil (L)"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Consum (L/100km)"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Cost (RON)"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Cost/km"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Alimentări"})]})}),(0,b.jsx)(l.TableBody,{children:R.map(a=>{let c=new Date(a.date),d=`${String(c.getDate()).padStart(2,"0")}/${String(c.getMonth()+1).padStart(2,"0")}/${c.getFullYear()}`;return(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:d}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.distance>0?`${a.distance.toFixed(2)} km`:"N/A"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.fuelUsed>0?`${a.fuelUsed.toFixed(2)} L`:"N/A"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:null!==a.consumption?`${a.consumption.toFixed(2)} L/100km`:"N/A"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.cost>0?`${a.cost.toFixed(2)} RON`:"N/A"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:null!==a.costPerKm?`${a.costPerKm.toFixed(2)} RON/km`:"N/A"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.transactions})]},a.date)})})]})})})]})]}):(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(p.Car,{className:"h-12 w-12 mx-auto text-slate-400 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Nu există date"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Nu există date pentru vehiculul și perioada selectată"})]})}):(0,b.jsx)(f.Card,{className:"bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",children:(0,b.jsxs)(f.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(w.Info,{className:"h-12 w-12 mx-auto text-blue-400 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"Selectează un vehicul"}),(0,b.jsx)("p",{className:"text-blue-700 dark:text-blue-300",children:'Alege un vehicul din lista de mai sus și apasă "Generează Raport" pentru a vedea statisticile zilnice'})]})})]})}a.s(["default",()=>A])}];

//# sourceMappingURL=b33f8_frontend-next_src_app_%28dashboard%29_fuel_reports_daily-vehicle_page_tsx_f1ca8e25._.js.map